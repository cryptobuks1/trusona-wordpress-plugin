<?php

include_once 'phar://phar/trusona-includes.phar.gz/jwt-functions.php';

use PHPUnit\Framework\TestCase;


final class TestJwtFunctions extends TestCase
{
  public function test_valid_token()
  {
    $jwt = 'eyJraWQiOiI5MGU2NzE0OS1hY2NiLTQxZDQtOGEyMC1mODkwYmZjNzA5OWQiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJuQHRydXNvbmEuY29tIiwiYXVkIjoiZnItb2lkYy10ZXN0IiwibmJmIjoxNTc2MTY0MDc0LCJpc3MiOiJodHRwczpcL1wvZ2F0ZXdheS5zdGFnaW5nLnRydXNvbmEubmV0IiwiZXhwIjoxODkxNTI0MDc0LCJpYXQiOjE1NzYxNjQwNzQsIm5vbmNlIjoiNGNoNm9vbmFqNHI2eTVza3FzajJ1OWlpNnprNjF4ayJ9.UpXOA9XP9myRk9XBwyzcIblKbe3UrCKaV9jrN2w7pAgmItJ1DUHHK-AfocW7KoJ5Swif-n0VfevDot1gvhnHO3fPTNScZS8jDp1QBQpTyiCH7JAlv4J2lVJkRW8w5dtEZBPZ1hj9nT0qYcdBR4PbL6iVfAW6T-fC9LSWxdvprqMmgujybkK5APWBoEkrmJ6tztNRavn9IP0818QLwelgHUGVF-WAc4vHb2n5GyodQIW4iWOG2FTdsQhuBb2MqT4rB-vnKmLHQyb2Gs8Bm9NnBC_ygyVaawlPawfJNcbCYHK_Nra_8UiLZ5VY76YT5aWtOOLXmQQx1jS8WYw4eOUsgg';
    $this->assertTrue(is_valid_jwt($jwt, false));
  }

  public function test_expired_token()
  {
    $jwt = 'eyJraWQiOiI5MGU2NzE0OS1hY2NiLTQxZDQtOGEyMC1mODkwYmZjNzA5OWQiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJuQHRydXNvbmEuY29tIiwiYXVkIjoiZnItb2lkYy10ZXN0IiwibmJmIjoxNTc2MTAyMzEzLCJpc3MiOiJodHRwczpcL1wvZ2F0ZXdheS5zdGFnaW5nLnRydXNvbmEubmV0IiwiZXhwIjoxNTc2MTM4MzEzLCJpYXQiOjE1NzYxMDIzMTMsIm5vbmNlIjoicmc2aWd6b2Z3MGFodWpuM3ZqMGhsemduYjdhdzIxayJ9.cuSrUwTPvVusr_kVrS9tG2SsALrp_YF_9FiA2eY7yJr9iEierwCGP3gufJ6aJBWtZHLZNmyoY_vbBlw2iwaA9omNI7vdftCcsnQZ6nUqgdxUDQokpGOSrSZjiJpcui0TBvpW8U-MM53QQf-LOhp0VTSsWEUi88aTgbnmnBVoyQIffL9xqG8pkab20tl0y-9J-LoLThjnU8vaKPNJ5zTxccKIjFWq0ORBs-ZY9vCTl7F7owPEMR4W8n5p-2uvyeHx7_AJwIphf7Lr2qQNteHQ8AQ2NvD51_FsBgw6Iw8PDa_yyH13Q4lWt8h0BvRCneGLzyMKTE1zOYf4TYo52Ol_1A';
    $this->assertFalse(is_valid_jwt($jwt, false));
  }
}

?>